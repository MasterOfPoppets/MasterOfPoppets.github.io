<!DOCTYPE html><html lang="en" data-reactid=".19hq5mrl88w" data-react-checksum="-798194347"><head data-reactid=".19hq5mrl88w.0"><meta charset="UTF-8" data-reactid=".19hq5mrl88w.0.0"/><meta http-equiv="X-UA-Compatible" content="IE=edge" data-reactid=".19hq5mrl88w.0.1"/><meta name="viewport" content="width=device-width, initial-scale=1" data-reactid=".19hq5mrl88w.0.2"/><meta name="description" content="" data-reactid=".19hq5mrl88w.0.3"/><meta name="author" content="Gareth Hughes" data-reactid=".19hq5mrl88w.0.4"/><title data-reactid=".19hq5mrl88w.0.5">Quantum Web Development</title><link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Italiana&amp;subset=latin" data-reactid=".19hq5mrl88w.0.6"/><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css" integrity="sha512-dTfge/zgoMYpP7QbHy4gWMEGsbsdZeCXz7irItjcC3sPUFtf0kuFbDz/ixG7ArTxmDjLXDmezHubeNikyKGVyQ==" crossorigin="anonymous" data-reactid=".19hq5mrl88w.0.7"/><link rel="stylesheet" href="/css/main.css" data-reactid=".19hq5mrl88w.0.8"/></head><body data-reactid=".19hq5mrl88w.1"><header class="header" data-reactid=".19hq5mrl88w.1.0"><nav class="navbar navbar-default navbar-fixed-top" data-reactid=".19hq5mrl88w.1.0.0"><div class="container-fluid" data-reactid=".19hq5mrl88w.1.0.0.0"><div class="navbar-header" data-reactid=".19hq5mrl88w.1.0.0.0.0"><button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false" data-reactid=".19hq5mrl88w.1.0.0.0.0.0"><span class="sr-only" data-reactid=".19hq5mrl88w.1.0.0.0.0.0.0">Toggle navigation</span><span class="icon-bar" data-reactid=".19hq5mrl88w.1.0.0.0.0.0.1"></span><span class="icon-bar" data-reactid=".19hq5mrl88w.1.0.0.0.0.0.2"></span><span class="icon-bar" data-reactid=".19hq5mrl88w.1.0.0.0.0.0.3"></span></button><a class="navbar-brand glyphicon glyphicon-home home-menu-link" aria-hidden="true" href="/" data-reactid=".19hq5mrl88w.1.0.0.0.0.1"></a></div><div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1" data-reactid=".19hq5mrl88w.1.0.0.0.1"><ul class="nav navbar-nav navbar-right" data-reactid=".19hq5mrl88w.1.0.0.0.1.0"><li data-reactid=".19hq5mrl88w.1.0.0.0.1.0.0"><a class="home-menu-link" href="/about" data-reactid=".19hq5mrl88w.1.0.0.0.1.0.0.0">About</a></li><li data-reactid=".19hq5mrl88w.1.0.0.0.1.0.1"><a class="home-menu-link" href="/portfolio" data-reactid=".19hq5mrl88w.1.0.0.0.1.0.1.0">Work</a></li><li data-reactid=".19hq5mrl88w.1.0.0.0.1.0.2"><a class="home-menu-link" href="/blog" data-reactid=".19hq5mrl88w.1.0.0.0.1.0.2.0">Blog</a></li></ul></div></div></nav></header><div class="portfolio-content" data-reactid=".19hq5mrl88w.1.1"><div class="jumbotron" data-reactid=".19hq5mrl88w.1.1.0"><div class="container" data-reactid=".19hq5mrl88w.1.1.0.0"><h1 data-reactid=".19hq5mrl88w.1.1.0.0.0">Setting up a basic GraphiQL server</h1></div></div><div class="container" data-reactid=".19hq5mrl88w.1.1.1"><div class="row" data-reactid=".19hq5mrl88w.1.1.1.0"><div class="col-xs-12 col-md-8 col-md-offset-2" data-reactid=".19hq5mrl88w.1.1.1.0.0"><article data-reactid=".19hq5mrl88w.1.1.1.0.0.0"><p data-reactid=".19hq5mrl88w.1.1.1.0.0.0.0">Lets start by exploring one of the more dev-centric aspects of GraphQL - introspection.</p><p data-reactid=".19hq5mrl88w.1.1.1.0.0.0.1">In GraphQL it is possible to create an introspection query that allows us to ask the server what kind of queries or modifications we are allowed to make, as well as what the type system looks like. This allows developers to build really neat tools that can assist when it comes to development. Imagine being able to introspect a query that you want to make and ensure that you are retrieving not only the exact fields that you want but also that they are then going to be used in the way that your front-end has been coded to expect!</p><p data-reactid=".19hq5mrl88w.1.1.1.0.0.0.2">To begin with introspection, we need to create ourselves a simple GraphQL server.</p><h3 data-reactid=".19hq5mrl88w.1.1.1.0.0.0.3">Creating the server</h3><p data-reactid=".19hq5mrl88w.1.1.1.0.0.0.4">First we need to install a few dependencies</p><blockquote data-reactid=".19hq5mrl88w.1.1.1.0.0.0.5">npm install koa koa-graphql koa-mount --save-dev</blockquote><p data-reactid=".19hq5mrl88w.1.1.1.0.0.0.6">Then we can write a barebones server:</p><div data-reactid=".19hq5mrl88w.1.1.1.0.0.0.7">loading...</div><p data-reactid=".19hq5mrl88w.1.1.1.0.0.0.8"><span data-reactid=".19hq5mrl88w.1.1.1.0.0.0.8.0">There are two things to note here. Firstly, we are passing a schema option - this is the core of GraphQL and we&#x27;ll get to it shortly. Secondly, we set the </span><code data-reactid=".19hq5mrl88w.1.1.1.0.0.0.8.1">graphiql</code><span data-reactid=".19hq5mrl88w.1.1.1.0.0.0.8.2"> flag to true. GraphiQL is a tool developed by Facebook to show off the power of introspection within GraphQL.</span></p><p data-reactid=".19hq5mrl88w.1.1.1.0.0.0.9">GraphiQL is a React component that is returned by this endpoint. It automatically fires an introspection query at the server. The results are accessed via a user interface which allows developers to create queries or modifications and test them against the server to see the results.</p><p data-reactid=".19hq5mrl88w.1.1.1.0.0.0.a"><span data-reactid=".19hq5mrl88w.1.1.1.0.0.0.a.0">You can see this running on the demo app </span><a href="http://netrunnerql.quantumweb.io/graphql" data-reactid=".19hq5mrl88w.1.1.1.0.0.0.a.1">here</a><span data-reactid=".19hq5mrl88w.1.1.1.0.0.0.a.2">.</span></p><p data-reactid=".19hq5mrl88w.1.1.1.0.0.0.b">So, now we have our basic GraphQL server setup and providing us an introspection endpoint. At the moment our introspection isn&#x27;t very helpful - we&#x27;re not actually allowing our GraphQL server to do anything. For that, we need to define a schema.</p><h3 data-reactid=".19hq5mrl88w.1.1.1.0.0.0.c">Creating the schema</h3><p data-reactid=".19hq5mrl88w.1.1.1.0.0.0.d">The schema is the core of your GraphQL server. It defines exactly what the server can do. Want a particular field returned from an endpoint - well it had better be defined in the schema first.</p><p data-reactid=".19hq5mrl88w.1.1.1.0.0.0.e"><span data-reactid=".19hq5mrl88w.1.1.1.0.0.0.e.0">For this demo application we shall start out with a very basic schema. Given that we are trying to make a database of cards, it would make sense to be able to get a list of all the cards as well as information on a specific card. Lets define a basic type of </span><code data-reactid=".19hq5mrl88w.1.1.1.0.0.0.e.1">Card</code><span data-reactid=".19hq5mrl88w.1.1.1.0.0.0.e.2">:</span></p><div data-reactid=".19hq5mrl88w.1.1.1.0.0.0.f">loading...</div><p data-reactid=".19hq5mrl88w.1.1.1.0.0.0.g">We are defining a Card to have (at least initially) a few basic properties. Title, subtitle and type are all strings and subtypes is a list of strings. We have also added a description to the type and the individual fields - this can aid development when exploring the schema.</p><p data-reactid=".19hq5mrl88w.1.1.1.0.0.0.h">Having defined a Card type, it makes sense to use this within our first basic GraphQL queries. We are going to expose two queries on our endpoint - one to simply return all the cards available, and a second to return a specific card by title. Here&#x27;s what that might look like:</p><div data-reactid=".19hq5mrl88w.1.1.1.0.0.0.i">loading...</div><p data-reactid=".19hq5mrl88w.1.1.1.0.0.0.j"><span data-reactid=".19hq5mrl88w.1.1.1.0.0.0.j.0">By adding the </span><code data-reactid=".19hq5mrl88w.1.1.1.0.0.0.j.1">query</code><span data-reactid=".19hq5mrl88w.1.1.1.0.0.0.j.2"> field to a GraphQLSchema we are able to define any number of queries that are available on this endpoint.</span></p><p data-reactid=".19hq5mrl88w.1.1.1.0.0.0.k"><span data-reactid=".19hq5mrl88w.1.1.1.0.0.0.k.0">To create a query to return all cards we define a name for it - allCards - and then define everything that can be included in the response when this query is run. We shall use our previously defined </span><code data-reactid=".19hq5mrl88w.1.1.1.0.0.0.k.1">cardType</code><span data-reactid=".19hq5mrl88w.1.1.1.0.0.0.k.2">. Our query can reply with any combination of the title, subtitle, type and subtypes fields!</span></p><p data-reactid=".19hq5mrl88w.1.1.1.0.0.0.l"><span data-reactid=".19hq5mrl88w.1.1.1.0.0.0.l.0">We define how our query actually responds by providing the </span><code data-reactid=".19hq5mrl88w.1.1.1.0.0.0.l.1">resolve</code><span data-reactid=".19hq5mrl88w.1.1.1.0.0.0.l.2"> function. In this case we are simply going to return a json object which just happens to have some card data in it. This json object contains all the information available for each card - GraphQL is responsible for filtering out the fields that the front-end hasn&#x27;t asked for!</span></p><p data-reactid=".19hq5mrl88w.1.1.1.0.0.0.m"><span data-reactid=".19hq5mrl88w.1.1.1.0.0.0.m.0">Our second query - to find a card by it&#x27;s title - requires us to pass query parameters. This is achieved by specifying an </span><code data-reactid=".19hq5mrl88w.1.1.1.0.0.0.m.1">args</code><span data-reactid=".19hq5mrl88w.1.1.1.0.0.0.m.2"> property on the query object. The args object specifies the name of a field that you want to query over, in this case title. As with everything else we&#x27;ve seen so far, this is typed and can have a description attached to it to aid development.</span></p><p data-reactid=".19hq5mrl88w.1.1.1.0.0.0.n"><span data-reactid=".19hq5mrl88w.1.1.1.0.0.0.n.0">The query parameters are then passed as the second argument to the </span><code data-reactid=".19hq5mrl88w.1.1.1.0.0.0.n.1">resolve</code><span data-reactid=".19hq5mrl88w.1.1.1.0.0.0.n.2"> function that we&#x27;ve already seen. We can then use these parameters with a library such as </span><a href="http://ramdajs.com/" data-reactid=".19hq5mrl88w.1.1.1.0.0.0.n.3">Ramda</a><span data-reactid=".19hq5mrl88w.1.1.1.0.0.0.n.4"> to filter our data before it is returned.</span></p><p data-reactid=".19hq5mrl88w.1.1.1.0.0.0.o"><span data-reactid=".19hq5mrl88w.1.1.1.0.0.0.o.0">With a basic schema now in place we can now play around with the GraphiQL introspection! A demo of this is currently running </span><a href="http://netrunnerql.quantumweb.io/graphql" data-reactid=".19hq5mrl88w.1.1.1.0.0.0.o.1">here</a><span data-reactid=".19hq5mrl88w.1.1.1.0.0.0.o.2">. This is currently a very basic start - next up I&#x27;m going to look at expanding the schema to cover the full requirements of the NetrunnerQL application.</span></p></article></div></div></div></div><script src="https://fb.me/react-0.14.6.min.js" data-reactid=".19hq5mrl88w.1.2"></script><script src="https://fb.me/react-dom-0.14.6.min.js" data-reactid=".19hq5mrl88w.1.3"></script><script src="/bundle.js" data-reactid=".19hq5mrl88w.1.4"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.min.js" data-reactid=".19hq5mrl88w.1.5"></script><script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js" integrity="sha512-K1qjQ+NcF2TYO/eI3M6v8EiNYZfA95pQumfvcVrTHtwQVDG+aHRqLi/ETn2uB+1JqwYqVG3LIvdm9lj6imS/pQ==" crossorigin="anonymous" data-reactid=".19hq5mrl88w.1.6"></script></body></html>